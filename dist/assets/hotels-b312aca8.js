import{r as u,j as e,S as F,P as r,t as ue,T as E,I as pe,e as b,f as M,M as S,B as xe,s as ge,w as me,h as fe,W as je}from"./index-2645332a.js";import{g as _e,p as be,d as ye}from"./hotel-30c6b3dd.js";import{D as W,a as z,b as K,G as j,c as G,T,d as m,E as ve,e as Ce,f as He,g as we,h as Se,i as Te,j as Pe,k as ke}from"./jspdf.plugin.autotable-9666bd39.js";import{T as _,O as De,I as Ae}from"./InputAdornment-472adb5f.js";import{B as y}from"./Button-c4b246cf.js";import{u as A,w as Ee}from"./xlsx-f5126985.js";import{C as Ne}from"./Container-b1a1dd66.js";import{C as Re}from"./Card-2e36717f.js";import"./axios-9b9683dd.js";import"./Menu-58305863.js";import"./typeof-7fd5df1e.js";const I={hotel_id:"",name:"",h_group:"",h_addr:"",h_region:"",h_plan_region:"",_id:""};function L({open:n,onClose:o,onSave:a,initialData:l,maxNumber:t}){const[i,c]=u.useState(I);u.useEffect(()=>{console.log(t),c(l?{...l}:{...I,hotel_id:t+1})},[l,t]);const p=g=>{const{name:x,value:f}=g.target;c({...i,[x]:f})},d=()=>{const g={...i};a(g),o()};return e.jsxs(W,{open:n,onClose:o,fullWidth:!0,children:[e.jsx(z,{sx:{bgcolor:"primary.main",color:"white"},children:l?"Edit Hotel":"New Hotel"}),e.jsx(K,{children:e.jsx(F,{spacing:3,children:e.jsxs(j,{container:!0,spacing:2,children:[e.jsx(j,{item:!0,xs:12,sm:6,children:e.jsx(_,{label:"Hotel No",name:"hotel_id",value:i.hotel_id,onChange:p,type:"number",fullWidth:!0,variant:"outlined"})}),e.jsx(j,{item:!0,xs:12,sm:6,children:e.jsx(_,{label:"Hotel Name",name:"name",value:i.name,onChange:p,fullWidth:!0,variant:"outlined"})}),e.jsx(j,{item:!0,xs:12,sm:6,children:e.jsx(_,{label:"Hotel Group",name:"h_group",value:i.h_group,onChange:p,fullWidth:!0,variant:"outlined"})}),e.jsx(j,{item:!0,xs:12,sm:6,children:e.jsx(_,{label:"Hotel Address",name:"h_addr",value:i.h_addr,onChange:p,fullWidth:!0,variant:"outlined"})}),e.jsx(j,{item:!0,xs:12,sm:6,children:e.jsx(_,{label:"Hotel Region",name:"h_region",value:i.h_region,onChange:p,fullWidth:!0,variant:"outlined"})}),e.jsx(j,{item:!0,xs:12,sm:6,children:e.jsx(_,{label:"Hotel Plan Region",name:"h_plan_region",value:i.h_plan_region,onChange:p,fullWidth:!0,variant:"outlined"})})]})})}),e.jsxs(G,{children:[e.jsx(y,{onClick:o,color:"inherit",children:"Cancel"}),e.jsx(y,{onClick:d,variant:"contained",children:"Save"})]})]})}L.propTypes={open:r.bool,onClose:r.func,onSave:r.func,initialData:r.object,maxNumber:r.any};function q({query:n}){return e.jsx(T,{children:e.jsx(m,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(ue,{sx:{textAlign:"center"},children:[e.jsx(E,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(E,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',n,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}q.propTypes={query:r.string};function B({id:n,name:o,hotel_id:a,h_group:l,h_addr:t,h_region:i,h_plan_region:c,editAction:p,deleteAction:d}){const[g,x]=u.useState(null),f=H=>{x(H.currentTarget)},P=()=>{x(null)},v=()=>{p(),x(null)},C=()=>{d(),x(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(T,{hover:!0,tabIndex:-1,role:"checkbox",children:[e.jsx(m,{children:a}),e.jsx(m,{children:o}),e.jsx(m,{children:l}),e.jsx(m,{children:t}),e.jsx(m,{children:i}),e.jsx(m,{children:c}),e.jsx(m,{align:"right",children:e.jsx(pe,{onClick:f,children:e.jsx(b,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(M,{open:!!g,anchorEl:g,onClose:P,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsxs(S,{onClick:v,children:[e.jsx(b,{icon:"eva:edit-fill",sx:{mr:2}}),"Edit"]}),e.jsxs(S,{onClick:C,sx:{color:"error.main"},children:[e.jsx(b,{icon:"eva:trash-2-outline",sx:{mr:2}}),"Delete"]})]})]})}B.propTypes={id:r.any,hotel_id:r.any,name:r.any,h_group:r.any,h_addr:r.any,h_region:r.any,h_plan_region:r.any,editAction:r.func,deleteAction:r.func};const Ie={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function Oe(n,o,a){return n?Math.max(0,(1+n)*o-a):0}function O(n,o,a){return n[a]===null?1:o[a]===null||o[a]<n[a]?-1:o[a]>n[a]?1:0}function Fe(n,o){return n==="desc"?(a,l)=>O(a,l,o):(a,l)=>-O(a,l,o)}function Me({inputData:n,comparator:o,filterName:a}){const l=n.map((t,i)=>[t,i]);return l.sort((t,i)=>{const c=o(t[0],i[0]);return c!==0?c:t[1]-i[1]}),n=l.map(t=>t[0]),a&&(n=n.filter(t=>t.name.toLowerCase().indexOf(a.toLowerCase())!==-1)),n}const We=n=>{const o=A.book_new(),a=[["Hotel Id","Hotel Name","Hotel Group","Hotel Address","Hotel Region","Hotel Plan Region"],...n.map(t=>[t.hotel_id,t.name,t.h_group,t.h_addr,t.h_region,t.h_plan_region])],l=A.aoa_to_sheet(a);A.book_append_sheet(o,l,"hotel"),Ee(o,`Hotels${Date.now()}.xlsx`)},ze=n=>{const o=new ve({unit:"pt",format:[1500,600]}),a=[{header:"Hotel Id",dataKey:"hotel_id"},{header:"Hotel Name",dataKey:"name"},{header:"Hotel Group",dataKey:"h_group"},{header:"Hotel Address",dataKey:"h_addr"},{header:"Hotel Region",dataKey:"h_region"},{header:"Hotel Plan Region",dataKey:"h_plan_region"}],l=n.map(t=>({hotel_id:t.hotel_id,name:t.name,h_group:t.h_group,h_addr:t.h_addr,h_region:t.h_region,h_plan_region:t.h_plan_region}));o.autoTable({head:[a.map(t=>t.header)],body:l.map(t=>a.map(i=>t[i.dataKey]))}),o.save(`Hotels${Date.now()}.pdf`)},Ke=ge(He)(({theme:n})=>({position:"sticky",top:0,backgroundColor:"#ddf4ff",zIndex:n.zIndex.appBar}));function U({order:n,orderBy:o,rowCount:a,headLabel:l,numSelected:t,onRequestSort:i,onSelectAllClick:c}){const p=d=>g=>{i(g,d)};return e.jsx(Ke,{children:e.jsx(T,{children:l.map(d=>e.jsx(m,{align:d.align||"left",sortDirection:o===d.id?n:!1,sx:{width:d.width,minWidth:d.minWidth,backgroundColor:"#aaf4ff",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:"4px",paddingTop:"10px",paddingBottom:"10px"},children:e.jsxs(Ce,{hideSortIcon:!0,active:o===d.id,direction:o===d.id?n:"asc",onClick:p(d.id),children:[d.label,o===d.id?e.jsx(xe,{sx:{...Ie},children:n==="desc"?"sorted descending":"sorted ascending"}):null]})},d.id))})})}U.propTypes={order:r.oneOf(["asc","desc"]),orderBy:r.string,rowCount:r.number,headLabel:r.array,numSelected:r.number,onRequestSort:r.func,onSelectAllClick:r.func};function $({emptyRows:n,height:o}){return n?e.jsx(T,{sx:{...o&&{height:o*n}},children:e.jsx(m,{colSpan:9})}):null}$.propTypes={emptyRows:r.number,height:r.number};function X({filterName:n,onFilterName:o,onNewHotel:a,pdfAction:l,excelAction:t}){const[i,c]=u.useState(null),p=f=>{c(f.currentTarget)},d=()=>{c(null)},g=()=>{l(),c(null)},x=()=>{t(),c(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(me,{sx:{height:96,display:"flex",justifyContent:"space-between",p:f=>f.spacing(0,1,0,3)},children:[e.jsx(De,{value:n,onChange:o,placeholder:"Search Hotel Name...",startAdornment:e.jsx(Ae,{position:"start",children:e.jsx(b,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),e.jsx(y,{variant:"contained",color:"inherit",startIcon:e.jsx(b,{icon:"eva:plus-fill"}),onClick:a,children:"New Hotel"}),e.jsxs(y,{onClick:p,sx:{ml:2},variant:"contained",color:"secondary",children:[e.jsx(b,{icon:"eva:more-vertical-fill"}),"Export Data"]})]}),e.jsxs(M,{open:!!i,anchorEl:i,onClose:d,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsx(S,{onClick:g,children:"PDF"}),e.jsx(S,{onClick:x,sx:{color:"error.main"},children:"EXCEL"})]})]})}X.propTypes={filterName:r.string,onFilterName:r.func,onNewHotel:r.func,pdfAction:r.func,excelAction:r.func};function Ge(){const[n,o]=u.useState([]),[a,l]=u.useState(0),[t,i]=u.useState("desc"),[c,p]=u.useState("_id"),[d,g]=u.useState(""),[x,f]=u.useState(15),[P,v]=u.useState(!1),[C,H]=u.useState(null),[J,k]=u.useState(!1),[Q,V]=u.useState(""),[Y,D]=u.useState(""),Z=(s,h)=>{h!==""&&(i(c===h&&t==="asc"?"desc":"asc"),p(h))},ee=(s,h)=>{l(h)},ne=s=>{l(0),f(parseInt(s.target.value,10))},te=s=>{l(0),g(s.target.value)},N=Me({inputData:n,comparator:Fe(t,c),filterName:d});u.useEffect(()=>{(async()=>{try{const h=await _e();h===500?alert("Network Error"):(o(h.data),console.log(h.max_num),D(h.max_num))}catch(h){console.error("Error fetching data:",h),alert("An unexpected error occurred")}})()},[]);const oe=()=>{H(null),v(!0)},ae=s=>{H(s),v(!0)},re=()=>{v(!1)},le=async s=>{console.log(s);const w=await be({newData:s});w===500?alert("Network Error"):(alert(C?"A data updated successfully":"A data added successfully"),o(w.data),D(w.max_num))},se=s=>{V(s._id),k(!0)},ie=async()=>{k(!1);const h=await ye({id:Q});h===500?alert("Network Error."):(alert("A data deleted successfully."),o(h.data),D(h.max_num))},R=()=>{k(!1)},de=()=>{ze(n)},ce=()=>{We(n)},he=!N.length&&!!d;return e.jsxs(Ne,{maxWidth:!1,children:[e.jsx(F,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(E,{variant:"h4",children:"Hotels"})}),e.jsxs(Re,{children:[e.jsx(X,{filterName:d,onFilterName:te,onNewHotel:oe,pdfAction:de,excelAction:ce}),e.jsx(fe,{children:e.jsx(we,{sx:{overflow:"auto",height:"76vh"},children:e.jsxs(Se,{sx:{minWidth:800},children:[e.jsx(U,{order:t,orderBy:c,onRequestSort:Z,headLabel:[{id:"hotel_id",label:"Hotel Id"},{id:"name",label:"Hotel Name"},{id:"h_group",label:"Hotel Group"},{id:"h_addr",label:"Hotel Address"},{id:"h_region",label:"Hotel Region"},{id:"h_plan_region",label:"Hotel Plan Region"},{id:"",label:""}]}),e.jsxs(Te,{children:[N.slice(a*x,a*x+x).map(s=>e.jsx(B,{id:s._id,name:s.name,hotel_id:s.hotel_id,h_group:s.h_group,h_addr:s.h_addr,h_region:s.h_region,h_plan_region:s.h_plan_region,deleteAction:()=>se(s),editAction:()=>ae(s)},s._id)),e.jsx($,{height:77,emptyRows:Oe(a,x,n.length)}),he&&e.jsx(q,{query:d})]})]})})}),e.jsx(Pe,{page:a,component:"div",count:n.length,rowsPerPage:x,onPageChange:ee,rowsPerPageOptions:[5,10,15,25,50,100],onRowsPerPageChange:ne})]}),e.jsx(L,{open:P,onClose:re,onSave:le,initialData:C,maxNumber:Y}),e.jsxs(W,{open:J,onClose:R,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(z,{id:"alert-dialog-title",children:"Confirm Deletion"}),e.jsx(K,{children:e.jsx(ke,{id:"alert-dialog-description",children:"Are you sure you want to delete this item? This action cannot be undone."})}),e.jsxs(G,{children:[e.jsx(y,{onClick:R,color:"primary",children:"Cancel"}),e.jsx(y,{onClick:ie,color:"error",autoFocus:!0,children:"Delete"})]})]})]})}function en(){return e.jsxs(e.Fragment,{children:[e.jsx(je,{children:e.jsx("title",{children:" Hotels "})}),e.jsx(Ge,{})]})}export{en as default};
