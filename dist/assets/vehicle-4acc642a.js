import{j as e,t as ue,T as _,P as r,r as u,S as F,I as pe,e as g,f as R,M as w,B as xe,s as me,w as fe,h as ge,W as je}from"./index-2645332a.js";import{g as ve,p as be,d as we}from"./vehicle-b94c298b.js";import{T as y,d as j,D as M,a as H,b as W,G as k,c as z,E as ye,e as Ce,f as Se,g as Te,h as ke,i as Pe,j as _e,k as De}from"./jspdf.plugin.autotable-9666bd39.js";import{T as O,O as Ee,I as Ae}from"./InputAdornment-472adb5f.js";import{B as v}from"./Button-c4b246cf.js";import{u as P,w as Ne}from"./xlsx-f5126985.js";import{C as Oe}from"./Container-b1a1dd66.js";import{C as Ie}from"./Card-2e36717f.js";import"./axios-9b9683dd.js";import"./Menu-58305863.js";import"./typeof-7fd5df1e.js";function L({query:n}){return e.jsx(y,{children:e.jsx(j,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(ue,{sx:{textAlign:"center"},children:[e.jsx(_,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(_,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',n,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}L.propTypes={query:r.string};const I={vehicle_id:"",name:"",_id:""};function q({open:n,onClose:t,onSave:a,initialData:s,maxNumber:o}){const[l,c]=u.useState(I);u.useEffect(()=>{console.log(o),c(s?{...s}:{...I,vehicle_id:o+1})},[s,o]);const m=p=>{const{name:x,value:f}=p.target;c({...l,[x]:f})},i=()=>{const p={...l};a(p),t()};return e.jsxs(M,{open:n,onClose:t,fullWidth:!0,children:[e.jsx(H,{sx:{bgcolor:"primary.main",color:"white"},children:s?"Edit Hotel":"New Hotel"}),e.jsx(W,{children:e.jsx(F,{spacing:3,children:e.jsxs(k,{container:!0,spacing:2,children:[e.jsx(k,{item:!0,xs:12,sm:12,children:e.jsx(O,{label:"Service No",name:"vehicle_id",value:l.vehicle_id,onChange:m,type:"number",fullWidth:!0,variant:"outlined"})}),e.jsx(k,{item:!0,xs:12,sm:12,children:e.jsx(O,{label:"Service Name",name:"name",value:l.name,onChange:m,fullWidth:!0,variant:"outlined"})})]})})}),e.jsxs(z,{children:[e.jsx(v,{onClick:t,color:"inherit",children:"Cancel"}),e.jsx(v,{onClick:i,variant:"contained",children:"Save"})]})]})}q.propTypes={open:r.bool,onClose:r.func,onSave:r.func,initialData:r.object,maxNumber:r.any};function B({id:n,name:t,vehicle_id:a,editAction:s,deleteAction:o}){const[l,c]=u.useState(null),m=f=>{c(f.currentTarget)},i=()=>{c(null)},p=()=>{s(),c(null)},x=()=>{o(),c(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(y,{hover:!0,tabIndex:-1,role:"checkbox",children:[e.jsx(j,{align:"center",children:a}),e.jsx(j,{align:"center",children:t}),e.jsx(j,{align:"right",children:e.jsx(pe,{onClick:m,children:e.jsx(g,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(R,{open:!!l,anchorEl:l,onClose:i,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsxs(w,{onClick:p,children:[e.jsx(g,{icon:"eva:edit-fill",sx:{mr:2}}),"Edit"]}),e.jsxs(w,{onClick:x,sx:{color:"error.main"},children:[e.jsx(g,{icon:"eva:trash-2-outline",sx:{mr:2}}),"Delete"]})]})]})}B.propTypes={id:r.any,vehicle_id:r.any,name:r.any,editAction:r.func,deleteAction:r.func};const Ve={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function Fe(n,t,a){return n?Math.max(0,(1+n)*t-a):0}function V(n,t,a){return n[a]===null?1:t[a]===null||t[a]<n[a]?-1:t[a]>n[a]?1:0}function Re(n,t){return n==="desc"?(a,s)=>V(a,s,t):(a,s)=>-V(a,s,t)}function Me({inputData:n,comparator:t,filterName:a}){const s=n.map((o,l)=>[o,l]);return s.sort((o,l)=>{const c=t(o[0],l[0]);return c!==0?c:o[1]-l[1]}),n=s.map(o=>o[0]),a&&(n=n.filter(o=>o.name.toLowerCase().indexOf(a.toLowerCase())!==-1)),n}const He=n=>{const t=P.book_new(),a=[["Vehicle No","Vehicle Type"],...n.map(o=>[o.vehicle_id,o.name])],s=P.aoa_to_sheet(a);P.book_append_sheet(t,s,"vehicle"),Ne(t,`vehicles${Date.now()}.xlsx`)},We=n=>{const t=new ye({unit:"pt",format:[1500,600]}),a=[{header:"Vehicle_id",dataKey:"vehicle_id"},{header:"Vehicle_type",dataKey:"name"}],s=n.map(o=>({vehicle_id:o.vehicle_id,name:o.name}));t.autoTable({head:[a.map(o=>o.header)],body:s.map(o=>a.map(l=>o[l.dataKey]))}),t.save(`vehicles${Date.now()}.pdf`)},ze=me(Se)(({theme:n})=>({position:"sticky",top:0,backgroundColor:"#ddf4ff",zIndex:n.zIndex.appBar}));function K({order:n,orderBy:t,rowCount:a,headLabel:s,numSelected:o,onRequestSort:l,onSelectAllClick:c}){const m=i=>p=>{l(p,i)};return e.jsx(ze,{children:e.jsx(y,{children:s.map(i=>e.jsx(j,{align:i.align||"left",sortDirection:t===i.id?n:!1,sx:{width:i.width,minWidth:i.minWidth,backgroundColor:"#aaf4ff",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:"4px",paddingTop:"10px",paddingBottom:"10px"},children:e.jsxs(Ce,{hideSortIcon:!0,active:t===i.id,direction:t===i.id?n:"asc",onClick:m(i.id),children:[i.label,t===i.id?e.jsx(xe,{sx:{...Ve},children:n==="desc"?"sorted descending":"sorted ascending"}):null]})},i.id))})})}K.propTypes={order:r.oneOf(["asc","desc"]),orderBy:r.string,rowCount:r.number,headLabel:r.array,numSelected:r.number,onRequestSort:r.func,onSelectAllClick:r.func};function U({emptyRows:n,height:t}){return n?e.jsx(y,{sx:{...t&&{height:t*n}},children:e.jsx(j,{colSpan:9})}):null}U.propTypes={emptyRows:r.number,height:r.number};function G({filterName:n,onFilterName:t,onNewHotel:a,pdfAction:s,excelAction:o}){const[l,c]=u.useState(null),m=f=>{c(f.currentTarget)},i=()=>{c(null)},p=()=>{s(),c(null)},x=()=>{o(),c(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(fe,{sx:{height:96,display:"flex",justifyContent:"space-between",p:f=>f.spacing(0,1,0,3)},children:[e.jsx(Ee,{value:n,onChange:t,placeholder:"Search Vehicle Type...",startAdornment:e.jsx(Ae,{position:"start",children:e.jsx(g,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),e.jsx(v,{variant:"contained",color:"inherit",startIcon:e.jsx(g,{icon:"eva:plus-fill"}),onClick:a,children:"New Vehicle"}),e.jsxs(v,{onClick:m,sx:{ml:2},variant:"contained",color:"secondary",children:[e.jsx(g,{icon:"eva:more-vertical-fill"}),"Export Data"]})]}),e.jsxs(R,{open:!!l,anchorEl:l,onClose:i,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsx(w,{onClick:p,children:"PDF"}),e.jsx(w,{onClick:x,sx:{color:"error.main"},children:"EXCEL"})]})]})}G.propTypes={filterName:r.string,onFilterName:r.func,onNewHotel:r.func,pdfAction:r.func,excelAction:r.func};function Le(){const[n,t]=u.useState([]),[a,s]=u.useState(0),[o,l]=u.useState("desc"),[c,m]=u.useState("_id"),[i,p]=u.useState(""),[x,f]=u.useState(15),[$,C]=u.useState(!1),[D,E]=u.useState(null),[X,S]=u.useState(!1),[J,Q]=u.useState(""),[Y,T]=u.useState(""),Z=(d,h)=>{h!==""&&(l(c===h&&o==="asc"?"desc":"asc"),m(h))},ee=(d,h)=>{s(h)},ne=d=>{s(0),f(parseInt(d.target.value,10))},te=d=>{s(0),p(d.target.value)},A=Me({inputData:n,comparator:Re(o,c),filterName:i});u.useEffect(()=>{(async()=>{try{const h=await ve();h===500?alert("Network Error"):(t(h.data),console.log(h.max_num),T(h.max_num))}catch(h){console.error("Error fetching data:",h),alert("An unexpected error occurred")}})()},[]);const ae=()=>{E(null),C(!0)},oe=d=>{E(d),C(!0)},se=()=>{C(!1)},re=async d=>{console.log(d);const b=await be({newData:d});b===500?alert("Network Error"):(alert(D?"A data updated successfully":"A data added successfully"),t(b.data),T(b.max_num))},ie=d=>{Q(d._id),S(!0)},le=async()=>{S(!1);const h=await we({id:J});h===500?alert("Network Error."):(alert("A data deleted successfully."),t(h.data),T(h.max_num))},N=()=>{S(!1)},ce=()=>{We(n)},de=()=>{He(n)},he=!A.length&&!!i;return e.jsxs(Oe,{maxWidth:!1,children:[e.jsx(F,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(_,{variant:"h4",children:"Vehicles"})}),e.jsxs(Ie,{children:[e.jsx(G,{filterName:i,onFilterName:te,onNewHotel:ae,pdfAction:ce,excelAction:de}),e.jsx(ge,{children:e.jsx(Te,{sx:{overflow:"auto",height:"76vh"},children:e.jsxs(ke,{sx:{minWidth:800},children:[e.jsx(K,{order:o,orderBy:c,onRequestSort:Z,headLabel:[{id:"vehicle_id",label:"Vehicle Id",align:"center"},{id:"name",label:"Vehicle Type",align:"center"},{id:"",label:""}]}),e.jsxs(Pe,{children:[A.slice(a*x,a*x+x).map(d=>e.jsx(B,{id:d._id,name:d.name,vehicle_id:d.vehicle_id,deleteAction:()=>ie(d),editAction:()=>oe(d)},d._id)),e.jsx(U,{height:77,emptyRows:Fe(a,x,n.length)}),he&&e.jsx(L,{query:i})]})]})})}),e.jsx(_e,{page:a,component:"div",count:n.length,rowsPerPage:x,onPageChange:ee,rowsPerPageOptions:[5,10,15,25,50,100],onRowsPerPageChange:ne})]}),e.jsx(q,{open:$,onClose:se,onSave:re,initialData:D,maxNumber:Y}),e.jsxs(M,{open:X,onClose:N,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(H,{id:"alert-dialog-title",children:"Confirm Deletion"}),e.jsx(W,{children:e.jsx(De,{id:"alert-dialog-description",children:"Are you sure you want to delete this item? This action cannot be undone."})}),e.jsxs(z,{children:[e.jsx(v,{onClick:N,color:"primary",children:"Cancel"}),e.jsx(v,{onClick:le,color:"error",autoFocus:!0,children:"Delete"})]})]})]})}function en(){return e.jsxs(e.Fragment,{children:[e.jsx(je,{children:e.jsx("title",{children:" Vehicles "})}),e.jsx(Le,{})]})}export{en as default};
