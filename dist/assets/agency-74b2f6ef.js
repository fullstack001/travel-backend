import{r as x,j as e,S as K,P as l,t as he,T as O,I as xe,e as v,f as H,M as P,B as me,s as pe,w as ge,h as ye,W as fe}from"./index-37c868fe.js";import{g as je,p as be,d as ve}from"./agency-a921e9d4.js";import{D as z,a as L,b as q,G as y,c as B,T as E,d as m,E as Ce,e as Te,f as Ae,g as Se,h as we,i as ke,j as Pe,k as Ee}from"./jspdf.plugin.autotable-ff90154c.js";import{T as j,O as Ne,I as _e}from"./InputAdornment-602fc9fc.js";import{B as C}from"./Button-ddf301b8.js";import{u as I,w as De}from"./xlsx-f5126985.js";import{C as Ie}from"./Container-c77749db.js";import{C as Oe}from"./Card-3d767025.js";import"./axios-9b9683dd.js";import"./Menu-e7019645.js";import"./typeof-7fd5df1e.js";const R={ageycy_id:"",name:"",country:"",tel:"",name2:"",email:"",website:"",status:"",tax:"",_id:""};function U({open:n,onClose:a,onSave:s,initialData:o,maxNumber:t}){const[r,d]=x.useState(R);x.useEffect(()=>{console.log(t),d(o?{...o}:{...R,ageycy_id:t+1})},[o,t]);const u=p=>{const{name:g,value:f}=p.target;d({...r,[g]:f})},c=()=>{const p={...r};s(p),a()};return e.jsxs(z,{open:n,onClose:a,fullWidth:!0,children:[e.jsx(L,{sx:{bgcolor:"primary.main",color:"white"},children:o?"Edit Agency":"New Agency"}),e.jsx(q,{children:e.jsx(K,{spacing:3,children:e.jsxs(y,{container:!0,spacing:2,children:[e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(j,{label:"Agemcy Id",name:"ageycy_id",value:r.ageycy_id,onChange:u,type:"number",fullWidth:!0,variant:"outlined"})}),e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(j,{label:"Agency Name",name:"name",value:r.name,onChange:u,fullWidth:!0,variant:"outlined"})}),e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(j,{label:"Country",name:"country",value:r.country,onChange:u,fullWidth:!0,variant:"outlined"})}),e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(j,{label:"Tel",name:"tel",value:r.tel,onChange:u,fullWidth:!0,variant:"outlined"})}),e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(j,{label:"Name2",name:"name2",value:r.name2,onChange:u,fullWidth:!0,variant:"outlined"})}),e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(j,{label:"Email",name:"email",value:r.email,onChange:u,fullWidth:!0,variant:"outlined"})}),e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(j,{label:"Website",name:"website",value:r.website,onChange:u,fullWidth:!0,variant:"outlined"})}),e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(j,{label:"Status",name:"status",value:r.status,onChange:u,fullWidth:!0,variant:"outlined"})}),e.jsx(y,{item:!0,xs:12,sm:6,children:e.jsx(j,{label:"Tax",name:"tax",value:r.tax,onChange:u,fullWidth:!0,variant:"outlined"})})]})})}),e.jsxs(B,{children:[e.jsx(C,{onClick:a,color:"inherit",children:"Cancel"}),e.jsx(C,{onClick:c,variant:"contained",children:"Save"})]})]})}U.propTypes={open:l.bool,onClose:l.func,onSave:l.func,initialData:l.object,maxNumber:l.any};function G({query:n}){return e.jsx(E,{children:e.jsx(m,{align:"center",colSpan:6,sx:{py:3},children:e.jsxs(he,{sx:{textAlign:"center"},children:[e.jsx(O,{variant:"h6",paragraph:!0,children:"Not found"}),e.jsxs(O,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',n,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}G.propTypes={query:l.string};function X({id:n,name:a,ageycy_id:s,country:o,tel:t,name2:r,email:d,website:u,status:c,tax:p,editAction:g,deleteAction:f}){const[A,b]=x.useState(null),S=_=>{b(_.currentTarget)},w=()=>{b(null)},N=()=>{g(),b(null)},T=()=>{f(),b(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(E,{hover:!0,tabIndex:-1,role:"checkbox",children:[e.jsx(m,{children:s}),e.jsx(m,{children:a}),e.jsx(m,{children:o}),e.jsx(m,{children:t}),e.jsx(m,{children:r}),e.jsx(m,{children:d}),e.jsx(m,{children:u}),e.jsx(m,{children:c}),e.jsx(m,{children:p}),e.jsx(m,{align:"right",children:e.jsx(xe,{onClick:S,children:e.jsx(v,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(H,{open:!!A,anchorEl:A,onClose:w,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsxs(P,{onClick:N,children:[e.jsx(v,{icon:"eva:edit-fill",sx:{mr:2}}),"Edit"]}),e.jsxs(P,{onClick:T,sx:{color:"error.main"},children:[e.jsx(v,{icon:"eva:trash-2-outline",sx:{mr:2}}),"Delete"]})]})]})}X.propTypes={id:l.any,ageycy_id:l.any,name:l.any,country:l.any,tel:l.any,name2:l.any,email:l.any,website:l.any,status:l.any,tax:l.any,deleteAction:l.func,editAction:l.func};const We={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function Fe(n,a,s){return n?Math.max(0,(1+n)*a-s):0}function M(n,a,s){return n[s]===null?1:a[s]===null||a[s]<n[s]?-1:a[s]>n[s]?1:0}function Re(n,a){return n==="desc"?(s,o)=>M(s,o,a):(s,o)=>-M(s,o,a)}function Me({inputData:n,comparator:a,filterName:s}){const o=n.map((t,r)=>[t,r]);return o.sort((t,r)=>{const d=a(t[0],r[0]);return d!==0?d:t[1]-r[1]}),n=o.map(t=>t[0]),s&&(n=n.filter(t=>t.name.toLowerCase().indexOf(s.toLowerCase())!==-1)),n}const Ke=n=>{const a=I.book_new(),s=[["Agency Id","Agency Name","Country","Tel","Name2","Email","Website","Status","Tax"],...n.map(t=>[t.ageycy_id,t.name,t.country,t.tel,t.name2,t.email,t.website,t.status,t.tax,t.adult,t.driver,t.guid,t.resa_remark])],o=I.aoa_to_sheet(s);I.book_append_sheet(a,o,"Agency"),De(a,"Agencies.xlsx")},He=n=>{const a=new Ce({orientation:"landscape",unit:"pt",format:[1500,600]}),s=[{header:"Agency Id",dataKey:"ageycy_id"},{header:"Agency Name",dataKey:"name"},{header:"Country",dataKey:"country"},{header:"Tel",dataKey:"tel"},{header:"Name2",dataKey:"name2"},{header:"Email",dataKey:"email"},{header:"Website",dataKey:"website"},{header:"Status",dataKey:"status"},{header:"Tax",dataKey:"tax"}],o=n.map(t=>({ageycy_id:t.ageycy_id,name:t.name,country:t.country,tel:t.tel,name2:t.name2,email:t.email,website:t.website,status:t.status,tax:t.tax}));a.autoTable({head:[s.map(t=>t.header)],body:o.map(t=>s.map(r=>t[r.dataKey]))}),a.save("Agencies.pdf")},ze=pe(Ae)(({theme:n})=>({position:"sticky",top:0,backgroundColor:"#ddf4ff",zIndex:n.zIndex.appBar}));function J({order:n,orderBy:a,rowCount:s,headLabel:o,numSelected:t,onRequestSort:r,onSelectAllClick:d}){const u=c=>p=>{r(p,c)};return e.jsx(ze,{children:e.jsx(E,{children:o.map(c=>e.jsx(m,{align:c.align||"left",sortDirection:a===c.id?n:!1,sx:{width:c.width,minWidth:c.minWidth,backgroundColor:"#aaf4ff",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:"4px",paddingTop:"10px",paddingBottom:"10px"},children:e.jsxs(Te,{hideSortIcon:!0,active:a===c.id,direction:a===c.id?n:"asc",onClick:u(c.id),children:[c.label,a===c.id?e.jsx(me,{sx:{...We},children:n==="desc"?"sorted descending":"sorted ascending"}):null]})},c.id))})})}J.propTypes={order:l.oneOf(["asc","desc"]),orderBy:l.string,rowCount:l.number,headLabel:l.array,numSelected:l.number,onRequestSort:l.func,onSelectAllClick:l.func};function Q({emptyRows:n,height:a}){return n?e.jsx(E,{sx:{...a&&{height:a*n}},children:e.jsx(m,{colSpan:9})}):null}Q.propTypes={emptyRows:l.number,height:l.number};function V({filterName:n,onFilterName:a,onNewHotel:s,pdfAction:o,excelAction:t}){const[r,d]=x.useState(null),u=f=>{d(f.currentTarget)},c=()=>{d(null)},p=()=>{o(),d(null)},g=()=>{t(),d(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(ge,{sx:{height:96,display:"flex",justifyContent:"space-between",p:f=>f.spacing(0,1,0,3)},children:[e.jsx(Ne,{value:n,onChange:a,placeholder:"Search Agency Name...",startAdornment:e.jsx(_e,{position:"start",children:e.jsx(v,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),e.jsx(C,{variant:"contained",color:"inherit",startIcon:e.jsx(v,{icon:"eva:plus-fill"}),onClick:s,children:"New Agency"}),e.jsxs(C,{onClick:u,sx:{ml:2},variant:"contained",color:"secondary",children:[e.jsx(v,{icon:"eva:more-vertical-fill"}),"Export Data"]})]}),e.jsxs(H,{open:!!r,anchorEl:r,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsx(P,{onClick:p,children:"PDF"}),e.jsx(P,{onClick:g,sx:{color:"error.main"},children:"EXCEL"})]})]})}V.propTypes={filterName:l.string,onFilterName:l.func,onNewHotel:l.func,pdfAction:l.func,excelAction:l.func};function Le(){const[n,a]=x.useState([]),[s,o]=x.useState(0),[t,r]=x.useState("desc"),[d,u]=x.useState("_id"),[c,p]=x.useState(""),[g,f]=x.useState(15),[A,b]=x.useState(!1),[S,w]=x.useState(null),[N,T]=x.useState(!1),[_,Y]=x.useState(""),[Z,D]=x.useState(""),$=(i,h)=>{h!==""&&(r(d===h&&t==="asc"?"desc":"asc"),u(h))},ee=(i,h)=>{o(h)},te=i=>{o(0),f(parseInt(i.target.value,10))},ne=i=>{o(0),p(i.target.value)},W=Me({inputData:n,comparator:Re(t,d),filterName:c});x.useEffect(()=>{(async()=>{try{const h=await je();h===500?alert("Network Error"):(a(h.data),console.log(h.max_num),D(h.max_num))}catch(h){console.error("Error fetching data:",h),alert("An unexpected error occurred")}})()},[]);const ae=()=>{w(null),b(!0)},se=i=>{w(i),b(!0)},le=()=>{b(!1)},ie=async i=>{console.log(i);const k=await be({newData:i});k===500?alert("Network Error"):(alert(S?"A data updated successfully":"A data added successfully"),a(k.data),D(k.max_num))},re=i=>{Y(i._id),T(!0)},oe=async()=>{T(!1);const h=await ve({id:_});h===500?alert("Network Error."):(alert("A data deleted successfully."),a(h.data),D(h.max_num))},F=()=>{T(!1)},ce=()=>{He(n)},de=()=>{Ke(n)},ue=!W.length&&!!c;return e.jsxs(Ie,{maxWidth:!1,children:[e.jsx(K,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(O,{variant:"h4",children:"Agencies"})}),e.jsxs(Oe,{children:[e.jsx(V,{filterName:c,onFilterName:ne,onNewHotel:ae,pdfAction:ce,excelAction:de}),e.jsx(ye,{children:e.jsx(Se,{sx:{overflow:"auto",height:"76vh"},children:e.jsxs(we,{sx:{minWidth:800},children:[e.jsx(J,{order:t,orderBy:d,onRequestSort:$,headLabel:[{id:"ageycy_id",label:"Agency Id"},{id:"name",label:"Agency Name"},{id:"country",label:"Country"},{id:"tel",label:"Tel"},{id:"name2",label:"Name2"},{id:"email",label:"Email"},{id:"website",label:"Website"},{id:"status",label:"Status"},{id:"tax",label:"Tax"},{id:"",label:""}]}),e.jsxs(ke,{children:[W.slice(s*g,s*g+g).map(i=>e.jsx(X,{id:i._id,ageycy_id:i.ageycy_id,name:i.name,country:i.country,tel:i.tel,name2:i.name2,email:i.email,website:i.website,status:i.status,tax:i.tax,deleteAction:()=>re(i),editAction:()=>se(i)},i._id)),e.jsx(Q,{height:77,emptyRows:Fe(s,g,n.length)}),ue&&e.jsx(G,{query:c})]})]})})}),e.jsx(Pe,{page:s,component:"div",count:n.length,rowsPerPage:g,onPageChange:ee,rowsPerPageOptions:[5,10,15,25,50,100],onRowsPerPageChange:te})]}),e.jsx(U,{open:A,onClose:le,onSave:ie,initialData:S,maxNumber:Z}),e.jsxs(z,{open:N,onClose:F,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(L,{id:"alert-dialog-title",children:"Confirm Deletion"}),e.jsx(q,{children:e.jsx(Ee,{id:"alert-dialog-description",children:"Are you sure you want to delete this item? This action cannot be undone."})}),e.jsxs(B,{children:[e.jsx(C,{onClick:F,color:"primary",children:"Cancel"}),e.jsx(C,{onClick:oe,color:"error",autoFocus:!0,children:"Delete"})]})]})]})}function et(){return e.jsxs(e.Fragment,{children:[e.jsx(fe,{children:e.jsx("title",{children:" agencies "})}),e.jsx(Le,{})]})}export{et as default};
