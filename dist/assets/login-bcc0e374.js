import{a7 as T,r as k,a as U,g as A,a8 as _,s as C,i as x,_ as i,a9 as z,u as q,b as W,j as n,c as G,d as F,aa as $,o as K,B as V,ab as J,l as O,S as L,T as Z,D as H,I as Q,e as X,W as Y}from"./index-2645332a.js";import{a as N}from"./axios-9b9683dd.js";import{u as tt}from"./userStroe-e97510fd.js";import{C as ot}from"./Card-2e36717f.js";import{T as B,I as rt}from"./InputAdornment-472adb5f.js";import{B as et}from"./Button-c4b246cf.js";import{u as nt}from"./useThemeProps-a1c2bdb3.js";import{u as st}from"./Menu-58305863.js";function at(){const o=T();return k.useMemo(()=>({back:()=>o(-1),forward:()=>o(1),reload:()=>window.location.reload(),push:r=>o(r),replace:r=>o(r,{replace:!0})}),[o])}function it(o){return U("MuiCircularProgress",o)}A("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const ct=["className","color","disableShrink","size","style","thickness","value","variant"];let j=o=>o,E,R,D,M;const m=44,dt=_(E||(E=j`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`)),lt=_(R||(R=j`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -125px;
  }
`)),ut=o=>{const{classes:t,variant:r,color:e,disableShrink:s}=o,a={root:["root",r,`color${x(e)}`],svg:["svg"],circle:["circle",`circle${x(r)}`,s&&"circleDisableShrink"]};return F(a,it,t)},gt=C("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(o,t)=>{const{ownerState:r}=o;return[t.root,t[r.variant],t[`color${x(r.color)}`]]}})(({ownerState:o,theme:t})=>i({display:"inline-block"},o.variant==="determinate"&&{transition:t.transitions.create("transform")},o.color!=="inherit"&&{color:(t.vars||t).palette[o.color].main}),({ownerState:o})=>o.variant==="indeterminate"&&z(D||(D=j`
      animation: ${0} 1.4s linear infinite;
    `),dt)),pt=C("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(o,t)=>t.svg})({display:"block"}),ht=C("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(o,t)=>{const{ownerState:r}=o;return[t.circle,t[`circle${x(r.variant)}`],r.disableShrink&&t.circleDisableShrink]}})(({ownerState:o,theme:t})=>i({stroke:"currentColor"},o.variant==="determinate"&&{transition:t.transitions.create("stroke-dashoffset")},o.variant==="indeterminate"&&{strokeDasharray:"80px, 200px",strokeDashoffset:0}),({ownerState:o})=>o.variant==="indeterminate"&&!o.disableShrink&&z(M||(M=j`
      animation: ${0} 1.4s ease-in-out infinite;
    `),lt)),ft=k.forwardRef(function(t,r){const e=q({props:t,name:"MuiCircularProgress"}),{className:s,color:a="primary",disableShrink:v=!1,size:c=40,style:g,thickness:p=3.6,value:h=0,variant:I="indeterminate"}=e,d=W(e,ct),f=i({},e,{color:a,disableShrink:v,size:c,thickness:p,value:h,variant:I}),l=ut(f),y={},P={},w={};if(I==="determinate"){const S=2*Math.PI*((m-p)/2);y.strokeDasharray=S.toFixed(3),w["aria-valuenow"]=Math.round(h),y.strokeDashoffset=`${((100-h)/100*S).toFixed(3)}px`,P.transform="rotate(-90deg)"}return n.jsx(gt,i({className:G(l.root,s),style:i({width:c,height:c},P,g),ownerState:f,ref:r,role:"progressbar"},w,d,{children:n.jsx(pt,{className:l.svg,ownerState:f,viewBox:`${m/2} ${m/2} ${m} ${m}`,children:n.jsx(ht,{className:l.circle,style:y,ownerState:f,cx:m,cy:m,r:(m-p)/2,fill:"none",strokeWidth:p})})}))}),mt=ft;function xt(o){return U("MuiLoadingButton",o)}const vt=A("MuiLoadingButton",["root","loading","loadingIndicator","loadingIndicatorCenter","loadingIndicatorStart","loadingIndicatorEnd","endIconLoadingEnd","startIconLoadingStart"]),u=vt,It=["children","disabled","id","loading","loadingIndicator","loadingPosition","variant"],yt=o=>{const{loading:t,loadingPosition:r,classes:e}=o,s={root:["root",t&&"loading"],startIcon:[t&&`startIconLoading${x(r)}`],endIcon:[t&&`endIconLoading${x(r)}`],loadingIndicator:["loadingIndicator",t&&`loadingIndicator${x(r)}`]},a=F(s,xt,e);return i({},e,a)},kt=o=>o!=="ownerState"&&o!=="theme"&&o!=="sx"&&o!=="as"&&o!=="classes",Pt=C(et,{shouldForwardProp:o=>kt(o)||o==="classes",name:"MuiLoadingButton",slot:"Root",overridesResolver:(o,t)=>[t.root,t.startIconLoadingStart&&{[`& .${u.startIconLoadingStart}`]:t.startIconLoadingStart},t.endIconLoadingEnd&&{[`& .${u.endIconLoadingEnd}`]:t.endIconLoadingEnd}]})(({ownerState:o,theme:t})=>i({[`& .${u.startIconLoadingStart}, & .${u.endIconLoadingEnd}`]:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},o.loadingPosition==="center"&&{transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),[`&.${u.loading}`]:{color:"transparent"}},o.loadingPosition==="start"&&o.fullWidth&&{[`& .${u.startIconLoadingStart}, & .${u.endIconLoadingEnd}`]:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0,marginRight:-8}},o.loadingPosition==="end"&&o.fullWidth&&{[`& .${u.startIconLoadingStart}, & .${u.endIconLoadingEnd}`]:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0,marginLeft:-8}})),bt=C("span",{name:"MuiLoadingButton",slot:"LoadingIndicator",overridesResolver:(o,t)=>{const{ownerState:r}=o;return[t.loadingIndicator,t[`loadingIndicator${x(r.loadingPosition)}`]]}})(({theme:o,ownerState:t})=>i({position:"absolute",visibility:"visible",display:"flex"},t.loadingPosition==="start"&&(t.variant==="outlined"||t.variant==="contained")&&{left:t.size==="small"?10:14},t.loadingPosition==="start"&&t.variant==="text"&&{left:6},t.loadingPosition==="center"&&{left:"50%",transform:"translate(-50%)",color:(o.vars||o).palette.action.disabled},t.loadingPosition==="end"&&(t.variant==="outlined"||t.variant==="contained")&&{right:t.size==="small"?10:14},t.loadingPosition==="end"&&t.variant==="text"&&{right:6},t.loadingPosition==="start"&&t.fullWidth&&{position:"relative",left:-10},t.loadingPosition==="end"&&t.fullWidth&&{position:"relative",right:-10})),Ct=k.forwardRef(function(t,r){const e=nt({props:t,name:"MuiLoadingButton"}),{children:s,disabled:a=!1,id:v,loading:c=!1,loadingIndicator:g,loadingPosition:p="center",variant:h="text"}=e,I=W(e,It),d=st(v),f=g??n.jsx(mt,{"aria-labelledby":d,color:"inherit",size:16}),l=i({},e,{disabled:a,loading:c,loadingIndicator:f,loadingPosition:p,variant:h}),y=yt(l),P=c?n.jsx(bt,{className:y.loadingIndicator,ownerState:l,children:f}):null;return n.jsxs(Pt,i({disabled:a||c,id:d,ref:r},I,{variant:h,classes:y,ownerState:l,children:[l.loadingPosition==="end"?s:P,l.loadingPosition==="end"?P:s]}))}),Lt=Ct;class b extends Error{}b.prototype.name="InvalidTokenError";function jt(o){return decodeURIComponent(atob(o).replace(/(.)/g,(t,r)=>{let e=r.charCodeAt(0).toString(16).toUpperCase();return e.length<2&&(e="0"+e),"%"+e}))}function $t(o){let t=o.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return jt(t)}catch{return atob(t)}}function wt(o,t){if(typeof o!="string")throw new b("Invalid token specified: must be a string");t||(t={});const r=t.header===!0?0:1,e=o.split(".")[r];if(typeof e!="string")throw new b(`Invalid token specified: missing part #${r+1}`);let s;try{s=$t(e)}catch(a){throw new b(`Invalid token specified: invalid base64 for part #${r+1} (${a.message})`)}try{return JSON.parse(s)}catch(a){throw new b(`Invalid token specified: invalid json for part #${r+1} (${a.message})`)}}const St=()=>{const o=$.get("token");let t;if(!o)t={isAuth:!1};else{const r=wt(o);r.exp*1e3<Date.now()?t={isAuth:!1}:t={isAuth:!0,...r.user}}return t},Bt=N.create({baseURL:"/api",withCredentials:!0});Bt.interceptors.request.use(o=>{const t=$.get("token");return t&&(o.headers.Authorization=`${t}`),o},o=>Promise.reject(o));const Et="http://127.0.0.1:5005",Rt=async o=>{var t,r;try{const e=await N.post(`${Et}/api/auth/signin`,o);return $.set("token",e.data.token,{expires:7,secure:!0,sameSite:"strict"}),200}catch(e){return console.error("Sign In Error:",((t=e.response)==null?void 0:t.data)||e.message),((r=e.response)==null?void 0:r.data)||{error:"An error occurred during sign in"}}};function Dt(){const o=K(),t=at(),{setUser:r}=tt(),e=St(),[s,a]=k.useState(""),[v,c]=k.useState(""),[g,p]=k.useState(!1),h=async()=>{await Rt({email:s,password:v})===200&&(r({...e,isAuth:!0}),t.push("/"))},I=n.jsxs(n.Fragment,{children:[n.jsxs(L,{spacing:3,children:[n.jsx(B,{name:"email",label:"Email address",value:s,onChange:d=>a(d.target.value)}),n.jsx(B,{name:"password",label:"Password",type:g?"text":"password",value:v,onChange:d=>c(d.target.value),InputProps:{endAdornment:n.jsx(rt,{position:"end",children:n.jsx(Q,{onClick:()=>p(!g),edge:"end",children:n.jsx(X,{icon:g?"eva:eye-fill":"eva:eye-off-fill"})})})}})]}),n.jsx(L,{direction:"row",alignItems:"center",justifyContent:"flex-end",sx:{my:3}}),n.jsx(Lt,{fullWidth:!0,size:"large",type:"submit",variant:"contained",color:"inherit",onClick:h,children:"Login"})]});return n.jsxs(V,{sx:{...J({color:O(o.palette.background.default,.9),imgUrl:"/assets/background/overlay_4.jpg"}),height:1},children:[n.jsx("img",{src:"/assets/logo.png",alt:"logo",style:{position:"fixed",top:{xs:16,md:24},left:{xs:16,md:24}}}),n.jsx(L,{alignItems:"center",justifyContent:"center",sx:{height:1},children:n.jsxs(ot,{sx:{p:5,width:1,maxWidth:700,text:"center"},children:[n.jsx(Z,{variant:"h4",alignItems:"center",justifyContent:"center",children:"Sign in to Escapadezanzibar Booking management"}),n.jsx(L,{direction:"row",spacing:2}),n.jsx(H,{sx:{my:3}}),I]})})]})}function Tt(){return n.jsxs(n.Fragment,{children:[n.jsx(Y,{children:n.jsx("title",{children:" Login "})}),n.jsx(Dt,{})]})}export{Tt as default};
