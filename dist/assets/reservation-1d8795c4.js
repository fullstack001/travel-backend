import{r as g,j as e,S as Y,T as F,P as i,I as Me,e as H,f as he,M as V,B as He,s as Le,w as ze,W as $e}from"./index-2645332a.js";import{g as Be}from"./hotel-30c6b3dd.js";import{g as Ge}from"./agency-a921e9d4.js";import{g as Ke}from"./service-744be99f.js";import{g as Je}from"./vehicle-b94c298b.js";import{p as Ue,d as qe,g as Ye,a as Ve,b as Xe}from"./resa-87a6fc8b.js";import{L as K,A as J,D as U,d as E,u as we}from"./utc-8aaacdb4.js";import{E as Qe,D as me,a as pe,b as fe,G as d,c as xe,T as oe,d as u,e as Ze,f as et,g as tt,h as at,i as nt,j as it,k as rt}from"./jspdf.plugin.autotable-9666bd39.js";import{u as le,w as lt}from"./xlsx-f5126985.js";import{T as m,O as st,I as ot}from"./InputAdornment-472adb5f.js";import{A as G}from"./Autocomplete-71648c72.js";import{B as L}from"./Button-c4b246cf.js";import{C as ct}from"./Container-b1a1dd66.js";import{C as dt}from"./Card-2e36717f.js";import"./axios-9b9683dd.js";import"./useThemeProps-a1c2bdb3.js";import"./Menu-58305863.js";import"./visuallyHidden-fa9934b5.js";import"./typeof-7fd5df1e.js";import"./usePreviousProps-40fa64ff.js";function q(s){const l=new Date(s);console.log(l);const h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=l.getDate(),t=h[l.getMonth()],v=l.getFullYear();return`${o}/${t}/${v}`}const ut={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"},O=s=>{if(!s)return"";const[l,h]=s.split(" ");let[o,t]=l.split(":");return h==="PM"&&o!=="12"&&(o=String(parseInt(o,10)+12)),h==="AM"&&o==="12"&&(o="00"),o=o.padStart(2,"0"),t=t.padStart(2,"0"),`${o}:${t}`};function ht(s,l,h){return s?Math.max(0,(1+s)*l-h):0}const mt=s=>{s.sort((t,v)=>new Date(v.service_date)-new Date(t.service_date));const l=le.book_new(),h=[["Dossier No","Service Type","Ar / Dep","Client Name","Agency Reference no","Agency","From","Hotel","Hotel Region","Service Date","End of Service","Adult","Child","Infant","Flight No","Flight Time"," Pick-up Time","Remarks","Service","Type of Vehicle","Adult Price","Child Price","Total Price","Currency","Invoice No","Status","Effect_date"],...s.map(t=>[t.dossier_no,t.service_type,t.arb_dep,t.client,t.agency_ref_no,t.agency,t.from,t.hotel,t.htl_region,q(t.service_date),q(t.endofservice),t.adult,t.child,t.infant,t.flight_no,O(t.flight_time),O(t.pickup_time),t.resa_remark,t.service,t.type_vehicle,t.adult_price,t.child_price,t.total_price,t.cur,t.invoce_on,t.status,t.effect_date])],o=le.aoa_to_sheet(h);le.book_append_sheet(l,o,"Daily Planning"),lt(l,`Maindata${Date.now()}.xlsx`)},pt=s=>{s.sort((t,v)=>new Date(v.service_date)-new Date(t.service_date));const l=new Qe({orientation:"landscape",unit:"pt",format:[2e3,800]}),h=[{datakey:"dossier_no",header:"Dossier No"},{datakey:"service_type",header:"Service Type"},{datakey:"arb_dep",header:"Ar / Dep"},{datakey:"client",header:"Client Name"},{datakey:"agency_ref_no",header:"Agency Reference no"},{datakey:"agency",header:"Agency"},{datakey:"from",header:"From"},{datakey:"hotel",header:"Hotel"},{datakey:"htl_region",header:"Hotel Region"},{datakey:"service_date",header:"Service Date"},{datakey:"endofservice",header:"End of Service"},{datakey:"adult",header:"Adult"},{datakey:"child",header:"Child"},{datakey:"infant",header:"Infant"},{datakey:"flight_no",header:"Flight No"},{datakey:"flight_time",header:"Flight Time"},{datakey:"pickup_time",header:" Pick-up Time"},{datakey:"resa_remark",header:"Remarks"},{datakey:"service",header:"Service"},{datakey:"type_vehicle",header:"Type of Vehicle"},{datakey:"adult_price",header:"Adult Price"},{datakey:"child_price",header:"Child Price"},{datakey:"total_price",header:"Total Price"},{datakey:"cur",header:"Currency"},{datakey:"invoce_on",header:"Invoice No"},{datakey:"status",header:"Status"},{datakey:"effect_date",header:"Effect_date"}],o=s.map(t=>({dossier_no:t.dossier_no,service_type:t.service_type,arb_dep:t.arb_dep,client:t.client,agency_ref_no:t.agency_ref_no,agency:t.agency,from:t.from,hotel:t.hotel,htl_region:t.htl_region,service_date:q(t.service_date),endofservice:q(t.endofservice),adult:t.adult,child:t.child,infant:t.infant,flight_no:t.flight_no,flight_time:O(t.flight_time),pickup_time:O(t.pickup_time),resa_remark:t.resa_remark,service:t.service,type_vehicle:t.type_vehicle,adult_price:t.adult_price,child_price:t.child_price,total_price:t.total_price,cur:t.cur,invoce_on:t.invoce_on,status:t.status,effect_date:q(t.effect_date)}));l.autoTable({head:[h.map(t=>t.header)],body:o.map(t=>h.map(v=>t[v.datakey]))}),l.save(`Maindata${Date.now()}.pdf`)},ue={adult:"",adult_price:"",agency_ref_no:"",agency:null,arb_dep:"",pickup_time:"",child:"",child_price:"",client:"",cur:"",date:"",type_vehicle:"",dossier_no:"",effect_date:"",endofservice:"",flight_no:"",flight_time:"",from:null,hotel:null,htl_region:"",infant:"",invoce_on:"",resa_remark:"",service:null,service_date:"",service_detail:"",service_type:"",status:"",total_price:"",_id:""};function ge({open:s,onClose:l,onSave:h,initialData:o,maxNumber:t,hotel:v,agency:b,service:A,vehicle:p}){const[r,k]=g.useState(ue);function P(a){const x=new Date(a);let j=x.getHours();const D=String(x.getMinutes()).padStart(2,"0"),M=j>=12?"PM":"AM";return j=j%12||12,`${String(j).padStart(2,"0")}:${D} ${M}`}g.useEffect(()=>{k(o?{...o,flight_time:O(o.flight_time),pickup_time:O(o.pickup_time)}:{...ue,dossier_no:t+1})},[o,t]);const c=a=>{console.log(a);const{name:x,value:j}=a.target;k({...r,[x]:j}),console.log(r)},R=()=>{const a={...r};Object.entries(a).forEach(([x,j])=>{if(j instanceof Date){const D=new Date(j),z=-D.getTimezoneOffset()/60===2?new Date(D.getTime()+108e5).toString():j;a[x]=z}else{const D=Date.parse(`1970-01-01T${j}`);Number.isNaN(D)||(a[x]=P(D))}}),h(a),l()},N=b.map(a=>({label:a.name,value:a.name})),C=v.map(a=>({label:a.name,value:a.name})),y=A.map(a=>({label:a.name,value:a.name})),S=p.map(a=>({label:a.name,value:a.name}));return e.jsxs(me,{open:s,onClose:l,maxWidth:"xl",fullWidth:!0,children:[e.jsx(pe,{sx:{bgcolor:"primary.main",color:"white"},children:o?"Edit Reservation":"New Reservation"}),e.jsx(fe,{children:e.jsxs(Y,{spacing:3,children:[e.jsx(F,{variant:"h6",sx:{mt:2},children:"General Information"}),e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{label:"Dossier No",name:"dossier_no",disabled:!0,value:r.dossier_no,onChange:c,fullWidth:!0,variant:"outlined"})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{label:"Client",name:"client",value:r.client,onChange:c,fullWidth:!0,variant:"outlined"})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{label:"Agency Reference no",name:"agency_ref_no",value:r.agency_ref_no,onChange:c,fullWidth:!0,variant:"outlined"})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(G,{options:N,getOptionLabel:a=>a.label,value:N.find(a=>a.value===r.agency)||null,onChange:(a,x)=>{c({target:{name:"agency",value:x?x.value:""}})},fullWidth:!0,renderInput:a=>e.jsx(m,{...a,label:"Agency",variant:"outlined"})})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(K,{dateAdapter:J,children:e.jsx(U,{label:"Service Date",name:"service_date",value:E(r.service_date),onChange:a=>k({...r,service_date:a?E(a).toDate():null}),renderInput:a=>e.jsx(m,{...a})})})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(K,{dateAdapter:J,children:e.jsx(U,{label:"End of Service",name:"endofservice",value:E(r.endofservice),onChange:a=>k({...r,endofservice:a?E(a).toDate():null}),renderInput:a=>e.jsx(m,{...a})})})})]}),e.jsx(F,{variant:"h6",sx:{mt:2},children:"Service Details"}),e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(G,{options:y,getOptionLabel:a=>a.label,value:y.find(a=>a.value===r.service)||null,onChange:(a,x)=>{c({target:{name:"service",value:x?x.value:""}})},fullWidth:!0,renderInput:a=>e.jsx(m,{...a,label:"Service",variant:"outlined"})})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{label:"Service Type",name:"service_type",value:r.service_type,onChange:c,fullWidth:!0,variant:"outlined"})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{label:"Arrival/Departure",name:"arb_dep",value:r.arb_dep,onChange:c,fullWidth:!0,variant:"outlined"})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{label:"Flight No",name:"flight_no",value:r.flight_no,onChange:c,fullWidth:!0,variant:"outlined"})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{label:"Flight Time",name:"flight_time",value:r.flight_time,onChange:c,fullWidth:!0,variant:"outlined",type:"time",InputLabelProps:{shrink:!0}})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{label:"Pickup Time",name:"pickup_time",value:r.pickup_time,onChange:c,fullWidth:!0,variant:"outlined",type:"time",InputLabelProps:{shrink:!0}})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(G,{options:C,getOptionLabel:a=>a.label,value:C.find(a=>a.value===r.from)||null,onChange:(a,x)=>{c({target:{name:"from",value:x?x.value:""}})},fullWidth:!0,renderInput:a=>e.jsx(m,{...a,label:"From",variant:"outlined"})})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(G,{options:C,getOptionLabel:a=>a.label,value:C.find(a=>a.value===r.hotel)||null,onChange:(a,x)=>{c({target:{name:"hotel",value:x?x.value:""}})},fullWidth:!0,renderInput:a=>e.jsx(m,{...a,label:"Hotel",variant:"outlined"})})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{label:"Hotel Region",name:"htl_region",value:r.htl_region,onChange:c,fullWidth:!0,variant:"outlined"})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(G,{options:S,getOptionLabel:a=>a.label,value:S.find(a=>a.value===r.type_vehicle)||null,onChange:(a,x)=>{c({target:{name:"type_vehicle",value:x?x.value:""}})},fullWidth:!0,renderInput:a=>e.jsx(m,{...a,label:"Type of Vehicle",variant:"outlined"})})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{label:"Remarks",name:"resa_remark",value:r.resa_remark,onChange:c,fullWidth:!0,variant:"outlined",multiline:!0,rows:4})})]}),e.jsx(F,{variant:"h6",sx:{mt:2},children:"Pricing Information"}),e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,sm:3,children:e.jsx(m,{label:"Adult",name:"adult",value:r.adult,onChange:c,fullWidth:!0,variant:"outlined",type:"number"})}),e.jsx(d,{item:!0,xs:12,sm:3,children:e.jsx(m,{label:"Adult Price",name:"adult_price",value:r.adult_price,onChange:c,fullWidth:!0,variant:"outlined",type:"number"})}),e.jsx(d,{item:!0,xs:12,sm:3,children:e.jsx(m,{label:"Child",name:"child",value:r.child,onChange:c,fullWidth:!0,variant:"outlined",type:"number"})}),e.jsx(d,{item:!0,xs:12,sm:3,children:e.jsx(m,{label:"Child Price",name:"child_price",value:r.child_price,onChange:c,fullWidth:!0,variant:"outlined",type:"number"})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{label:"Total Price",name:"total_price",value:r.total_price,onChange:c,fullWidth:!0,variant:"outlined",type:"number"})})]}),e.jsx(F,{variant:"h6",sx:{mt:2},children:"Additional Information"}),e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{label:"Currency",name:"cur",value:r.cur,onChange:c,fullWidth:!0,variant:"outlined"})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{label:"Invoice No",name:"inv_no",value:r.inv_no,onChange:c,fullWidth:!0,variant:"outlined"})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(K,{dateAdapter:J,children:e.jsx(U,{label:"Effect Date",name:"effect_date",value:E(r.effect_date),onChange:a=>k({...r,effect_date:a?E(a).toDate():null}),renderInput:a=>e.jsx(m,{...a})})})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(m,{label:"Status",name:"status",value:r.status,onChange:c,fullWidth:!0,variant:"outlined"})})]})]})}),e.jsxs(xe,{children:[e.jsx(L,{onClick:l,color:"inherit",children:"Cancel"}),e.jsx(L,{onClick:R,variant:"contained",children:"Save"})]})]})}ge.propTypes={open:i.bool,onClose:i.func,onSave:i.func,initialData:i.object,maxNumber:i.any,hotel:i.any,agency:i.any,service:i.any,vehicle:i.any};function se(s){if(!s)return"";const l=new Date(s),h=String(l.getDate()).padStart(2,"0"),o=String(l.getMonth()+1).padStart(2,"0");return`${l.getFullYear()}-${o}-${h}`}function ve({selected:s,id:l,dossier_no:h,service_type:o,arb_dep:t,client:v,agency_ref_no:b,agency:A,from:p,hotel:r,htl_region:k,service_date:P,endofservice:c,type_vehicle:R,adult:N,child:C,infant:y,flight_no:S,flight_time:a,pickup_time:x,resa_remark:j,service:D,adult_price:M,child_price:z,total_price:X,cur:w,invoce_on:Q,status:Z,effect_date:ee,editAction:te,deleteAction:ae}){const[$,T]=g.useState(null),ne=re=>{T(re.currentTarget)},W=()=>{T(null)},ie=()=>{te(),T(null)},I=()=>{ae(),T(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(oe,{hover:!0,tabIndex:-1,role:"checkbox",selected:s,children:[e.jsx(u,{align:"right",children:e.jsx(Me,{onClick:ne,children:e.jsx(H,{icon:"eva:more-vertical-fill"})})}),e.jsx(u,{component:"th",scope:"row",children:e.jsx(Y,{direction:"row",alignItems:"center",spacing:2,children:e.jsx(F,{variant:"subtitle2",noWrap:!0,children:h})})}),e.jsx(u,{component:"th",scope:"row",children:e.jsx(Y,{direction:"row",alignItems:"center",spacing:2,children:e.jsx(F,{variant:"subtitle2",noWrap:!0,children:o})})}),e.jsx(u,{children:t}),e.jsx(u,{children:v}),e.jsx(u,{children:b}),e.jsx(u,{children:A}),e.jsx(u,{children:p}),e.jsx(u,{children:r}),e.jsx(u,{children:k}),e.jsx(u,{children:se(P)}),e.jsx(u,{children:se(c)}),e.jsx(u,{children:N}),e.jsx(u,{children:C}),e.jsx(u,{children:y}),e.jsx(u,{children:S}),e.jsx(u,{children:O(a)}),e.jsx(u,{children:O(x)}),e.jsx(u,{children:j}),e.jsx(u,{children:D}),e.jsx(u,{children:R}),e.jsx(u,{children:M}),e.jsx(u,{children:z}),e.jsx(u,{children:X}),e.jsx(u,{children:w}),e.jsx(u,{children:Q}),e.jsx(u,{children:Z}),e.jsx(u,{children:se(ee)})]}),e.jsxs(he,{open:!!$,anchorEl:$,onClose:W,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsxs(V,{onClick:ie,children:[e.jsx(H,{icon:"eva:edit-fill",sx:{mr:2}}),"Edit"]}),e.jsxs(V,{onClick:I,sx:{color:"error.main"},children:[e.jsx(H,{icon:"eva:trash-2-outline",sx:{mr:2}}),"Delete"]})]})]})}ve.propTypes={id:i.any,dossier_no:i.any,service_type:i.any,arb_dep:i.any,client:i.any,agency_ref_no:i.any,agency:i.any,from:i.any,hotel:i.any,htl_region:i.any,service_date:i.any,endofservice:i.any,type_vehicle:i.any,pickup_time:i.any,adult:i.any,child:i.any,infant:i.any,flight_no:i.any,flight_time:i.any,resa_remark:i.any,service:i.any,adult_price:i.any,child_price:i.any,total_price:i.any,cur:i.any,invoce_on:i.any,status:i.any,effect_date:i.any,selected:i.any,editAction:i.func,deleteAction:i.func};const ft=Le(et)(({theme:s})=>({position:"sticky",top:0,backgroundColor:"#ddf4ff",zIndex:s.zIndex.appBar}));function _e({order:s,orderBy:l,rowCount:h,headLabel:o,numSelected:t,onRequestSort:v,onSelectAllClick:b}){const A=p=>r=>{v(r,p)};return e.jsx(ft,{children:e.jsx(oe,{children:o.map(p=>e.jsx(u,{align:p.align||"left",sortDirection:l===p.id?s:!1,sx:{width:p.width,minWidth:p.minWidth,backgroundColor:"#aaf4ff",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:"4px",paddingTop:"10px",paddingBottom:"10px"},children:e.jsxs(Ze,{hideSortIcon:!0,active:l===p.id,direction:l===p.id?s:"asc",onClick:A(p.id),children:[p.label,l===p.id?e.jsx(He,{sx:{...ut},children:s==="desc"?"sorted descending":"sorted ascending"}):null]})},p.id))})})}_e.propTypes={order:i.oneOf(["asc","desc"]),orderBy:i.string,rowCount:i.number,headLabel:i.array,numSelected:i.number,onRequestSort:i.func,onSelectAllClick:i.func};function ye({emptyRows:s,height:l}){return s?e.jsx(oe,{sx:{...l&&{height:l*s}},children:e.jsx(u,{colSpan:9})}):null}ye.propTypes={emptyRows:i.number,height:i.number};E.extend(we);function je({onGetDate:s,onGetEndDate:l,filterName:h,onFilterName:o,onNewResa:t,loading:v,excelAction:b,pdfAction:A}){const[p,r]=g.useState(null),k=y=>{const S=E(y).toDate();s(S)},P=y=>{const S=E(y).toDate();l(S)},c=y=>{r(y.currentTarget)},R=()=>{r(null)},N=()=>{A(),r(null)},C=()=>{b(),r(null)};return e.jsxs(e.Fragment,{children:[e.jsxs(ze,{sx:{height:96,display:"flex",justifyContent:"space-between",p:y=>y.spacing(0,1,0,3)},children:[e.jsx(st,{value:h,onChange:o,placeholder:"Search Client Name...",startAdornment:e.jsx(ot,{position:"start",children:e.jsx(H,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),e.jsx(K,{dateAdapter:J,children:e.jsx(U,{label:"Select Start Date",onChange:k,renderInput:y=>e.jsx(m,{...y})})}),e.jsx(K,{dateAdapter:J,sx:{ml:4},children:e.jsx(U,{sx:{ml:4},label:"Select End Date",onChange:P,renderInput:y=>e.jsx(m,{...y})})}),e.jsx(L,{variant:"contained",color:"inherit",startIcon:e.jsx(H,{icon:"eva:plus-fill"}),onClick:t,disabled:v,children:v?"Loading data...":"New Reservation"}),e.jsxs(L,{onClick:c,sx:{ml:2},variant:"contained",color:"secondary",children:[e.jsx(H,{icon:"eva:more-vertical-fill"}),"Export Data"]})]}),e.jsxs(he,{open:!!p,anchorEl:p,onClose:R,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsx(V,{onClick:N,children:"PDF"}),e.jsx(V,{onClick:C,sx:{color:"error.main"},children:"EXCEL"})]})]})}je.propTypes={filterName:i.string,onFilterName:i.func,onNewResa:i.func,loading:i.any,pdfAction:i.func,excelAction:i.func,onGetDate:i.func,onGetEndDate:i.func};function xt(){const[s,l]=g.useState([]),[h,o]=g.useState(0),[t,v]=g.useState(0),[b,A]=g.useState("desc"),[p,r]=g.useState("_id"),[k,P]=g.useState(!1),[c,R]=g.useState(null),[N,C]=g.useState(!1),[y,S]=g.useState(""),[a,x]=g.useState(""),[j,D]=g.useState(""),[M,z]=g.useState([]),[X,w]=g.useState([]),[Q,Z]=g.useState([]),[ee,te]=g.useState([]),[ae,$]=g.useState(!1),[T,ne]=g.useState(null),[W,ie]=g.useState(null),[I,re]=g.useState(15);g.useEffect(()=>{(async()=>{try{$(!0);const f=await Be(),_=await Ge(),B=await Ke(),Fe=await Je();z(f.data),w(_.data),Z(B.data),te(Fe.data)}catch{alert("network Error. Refresh page")}finally{$(!1)}})()},[]);const be=(n,f)=>{f!==""&&(A(p===f&&b==="asc"?"desc":"asc"),r(f))},De=n=>{o(0),x(n.target.value)},ke=()=>{R(null),P(!0)},Ce=n=>{R(n),P(!0)},Se=()=>{P(!1)},Te=async n=>{const f={filterData:a,orderKey:b,orderDirect:p,newData:n,page:h+1,limit:I},_=await Ue(f);_===500?alert("Network Error"):(alert(c?"A data updated successfully":"A data added successfully"),D(_.maxDossierNo),l(_.data),v(_.totalItems))},Ae=(n,f)=>{o(f)},Pe=n=>{o(0),re(parseInt(n.target.value,10))},Ie=n=>{S(n._id),C(!0)},ce=()=>{C(!1)},Ee=async()=>{C(!1);const n={filterData:a,orderKey:b,orderDirect:p,id:y,page:h+1,limit:I},f=await qe(n);f===500?alert("Network Error."):(alert("A data deleted successfully."),D(f.maxDossierNo),l(f.data),v(f.totalItems))},Re=async n=>{const f=new Date(n),B=-f.getTimezoneOffset()/60===2?new Date(f.getTime()+108e5).toString():n;ne(B)},Ne=async n=>{const f=new Date(n),B=-f.getTimezoneOffset()/60===2?new Date(f.getTime()+108e5).toString():n;ie(B)};g.useEffect(()=>{(async()=>{if(!T||!W){const f={filterData:a,orderKey:b,orderDirect:p,page:h+1,limit:I},_=await Ye(f);_.status===500?alert("Network Error"):(D(_.maxDossierNo),l(_.data),v(_.totalItems))}else{if(T>W){alert("Input currece Date!");return}try{const f={start:T,end:W,filterData:a,orderKey:b,orderDirect:p,page:h+1,limit:I},_=await Ve(f);_===500?alert("Network Error"):(D(_.maxDossierNo),l(_.data),v(_.totalItems))}catch(f){console.error("Error fetching data:",f),alert("An unexpected error occurred")}}})()},[T,W,h,I,b,p,a]);const de=async()=>(await Xe({start:T,end:W})).data,Oe=async()=>{const n=await de();pt(n)},We=async()=>{const n=await de();mt(n)};return e.jsxs(ct,{maxWidth:!1,children:[e.jsx(Y,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(F,{variant:"h4",children:"Reservation"})}),e.jsxs(dt,{children:[e.jsx(je,{filterName:a,onFilterName:De,onNewResa:ke,loading:ae,onGetDate:Re,onGetEndDate:Ne,pdfAction:Oe,excelAction:We}),e.jsx(tt,{sx:{overflow:"auto",height:"76vh"},children:e.jsxs(at,{sx:{minWidth:800},children:[e.jsx(_e,{order:b,orderBy:p,rowCount:s.length,onRequestSort:be,headLabel:[{id:""},{id:"dossier_no",label:"Dossier No"},{id:"service_type",label:"Service Type"},{id:"arb_dep",label:"Ar / Dep"},{id:"client",label:"Client Name"},{id:"agency_ref_no",label:"Agency Reference no"},{id:"agency",label:"Agency"},{id:"from",label:"From"},{id:"hotel",label:"Hotel"},{id:"htl_region",label:"Hotel Region"},{id:"service_date",label:"Service Date"},{id:"endofservice",label:"End of Service"},{id:"adult",label:"Adult"},{id:"child",label:"Child"},{id:"infant",label:"Infant"},{id:"flight_no",label:"Flight No"},{id:"flight_time",label:"Flight Time"},{id:"pickup_time",label:" Pick-up Time"},{id:"resa_remark",label:"Remarks"},{id:"service",label:"Service"},{id:"type_vehicle",label:"Type of Vehicle"},{id:"adult_price",label:"Adult Price"},{id:"child_price",label:"Child Price"},{id:"total_price",label:"Total Price"},{id:"cur",label:"Currency"},{id:"invoce_on",label:"Invoice No"},{id:"status",label:"Status"},{id:"effect_date",label:"Effect_date"}]}),e.jsxs(nt,{children:[s.map(n=>e.jsx(ve,{id:n._id,dossier_no:n.dossier_no,service_type:n.service_type,arb_dep:n.arb_dep,client:n.client,agency_ref_no:n.agency_ref_no,agency:n.agency,from:n.from,hotel:n.hotel,htl_region:n.htl_region,service_date:n.service_date,endofservice:n.endofservice,adult:n.adult,child:n.child,infant:n.infant,flight_no:n.flight_no,flight_time:n.flight_time,pickup_time:n.pickup_time,resa_remark:n.resa_remark,service:n.service,type_vehicle:n.type_vehicle,adult_price:n.adult_price,child_price:n.child_price,total_price:n.total_price,cash_credit:n.cash_credit,cur:n.cur,invoce_on:n.invoce_on,status:n.status,effect_date:n.effect_date,deleteAction:()=>Ie(n),editAction:()=>Ce(n)},n._id)),e.jsx(ye,{height:77,emptyRows:ht(h,I,t)})]})]})}),e.jsx(it,{page:h,component:"div",count:t,rowsPerPage:I,onPageChange:Ae,rowsPerPageOptions:[5,10,15,25,50,100],onRowsPerPageChange:Pe})]}),e.jsx(ge,{open:k,onClose:Se,onSave:Te,initialData:c,maxNumber:j,hotel:M,agency:X,service:Q,vehicle:ee}),e.jsxs(me,{open:N,onClose:ce,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(pe,{id:"alert-dialog-title",children:"Confirm Deletion"}),e.jsx(fe,{children:e.jsx(rt,{id:"alert-dialog-description",children:"Are you sure you want to delete this item? This action cannot be undone."})}),e.jsxs(xe,{children:[e.jsx(L,{onClick:ce,color:"primary",children:"Cancel"}),e.jsx(L,{onClick:Ee,color:"error",autoFocus:!0,children:"Delete"})]})]})]})}function Mt(){return e.jsxs(e.Fragment,{children:[e.jsx($e,{children:e.jsx("title",{children:" Reservations "})}),e.jsx(xt,{})]})}export{Mt as default};
